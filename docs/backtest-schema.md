# Backtest Artifact Schema

当前回测导出工件（JSON + CSV）使用统一 `schema_version`，用于兼容解析。

- 当前版本：`1.0`
- 兼容策略：`major` 相同即兼容（`1.x` 互相兼容）

## v1.x 兼容约定

1. 不删除已有字段
2. 新增字段仅追加（消费者应忽略未知字段）
3. 小版本（`1.0` -> `1.1`）允许新增可选字段
4. 大版本（`1.x` -> `2.0`）表示不兼容变更

## 消费端建议

- 先读取 `schema_version`
- 用 `parse_schema_version` / `assert_schema_compatible` 做版本检查
- 对 CSV 采用“已知字段优先 + 忽略未知列”

## 迁移指南（v1.x -> v2 预案）

当需要进行不兼容调整（例如字段重命名、语义变化）时：

1. 回测导出改为 `2.0`
2. 同期提供迁移脚本（`v1_to_v2`）
3. 在一个发布周期内并行支持：
   - 读取端支持 `1.x` 与 `2.x`
   - 写出端默认 `2.x`（可选开关回写 `1.x`）
4. 迁移稳定后移除 `1.x` 读取支持
